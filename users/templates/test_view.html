{% extends "index.html" %}
{% block content %}
    {% for tab in tab_names %}
        {{ tab }}
    {% endfor %}
{##}
{#<script src="https://requirejs.org/docs/release/2.3.5/minified/require.js">#}
{#const pg = require('pg');#}
{#const { Client } = pg;#}
{##}
{#const updateTables = async () => {#}
{##}
{#  const client = new Client({#}
{#    user: 'postgres',#}
{#    host: 'localhost',#}
{#    database: 'instyle',#}
{#    password: 'password',#}
{#    port: 5432,#}
{#  });#}
{##}
{#  await client.connect();#}
{##}
{#  console.log('Connected');#}
{##}
{#  const execQuery = async (queryStr, params = []) => {#}
{#    return new Promise((resolve, reject) => {#}
{#      client.query(queryStr, params, (error, results) => {#}
{#        if (error) {#}
{#          reject(error);#}
{#        } else {#}
{#          resolve(results);#}
{#        }#}
{#      })#}
{#    })#}
{#  }#}
{##}
{#  const tablesRes = await execQuery(`#}
{#    SELECT table_name#}
{#    FROM information_schema.tables#}
{#    WHERE table_type='BASE TABLE'#}
{#    AND table_schema='public';#}
{#  `)#}
{##}
{#  const tables = tablesRes.rows.map(row => row.table_name);#}
{##}
{#  tables.map(async tableName => {#}
{#    let lastId;#}
{#    try {#}
{#      const res = await execQuery(`SELECT id from "${tableName}" ORDER BY id DESC LIMIT 1`);#}
{#      lastId = res.rows[0].id;#}
{#    } catch (e) {}#}
{##}
{#    if (lastId) {#}
{#      const nextId = lastId + 1;#}
{#      const queryStr = `ALTER SEQUENCE ${tableName}_id_seq RESTART WITH ${nextId}`;#}
{#      await execQuery(queryStr);#}
{#      console.log(tableName, queryStr);#}
{#    }#}
{#  })#}
{##}
{#};#}
{##}
{#updateTables();#}
{##}
{#    </script>#}
{% endblock %}

